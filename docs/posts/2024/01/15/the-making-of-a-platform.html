<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="The making of a platform" />
<meta property="og:locale" content="en" />
<meta name="description" content="I got inspired by Flipper Zero and started developing an application platform for ESP32 touchscreen devices." />
<meta property="og:description" content="I got inspired by Flipper Zero and started developing an application platform for ESP32 touchscreen devices." />
<link rel="canonical" href="/posts/2024/01/15/the-making-of-a-platform.html" />
<meta property="og:url" content="/posts/2024/01/15/the-making-of-a-platform.html" />
<meta property="og:site_name" content="ByteWelder" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-01-15T21:30:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The making of a platform" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2026-01-24T18:00:00+01:00","datePublished":"2024-01-15T21:30:00+01:00","description":"I got inspired by Flipper Zero and started developing an application platform for ESP32 touchscreen devices.","headline":"The making of a platform","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/2024/01/15/the-making-of-a-platform.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/images/favicon.svg"}},"url":"/posts/2024/01/15/the-making-of-a-platform.html"}</script>
<!-- End Jekyll SEO tag -->


  <title>The making of a platform | ByteWelder
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">



  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/bytewelder.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">ByteWelder</a>
    <p class="site-subtitle fst-italic mb-0">Learnings, experiments and projects</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    

      
        <a
          href="https://github.com/ByteWelder"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
          
        

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
        
          
        
          
        
          
            
              <span>The making of a platform</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="false">
  <header>
    <h1 data-toc-skip>The making of a platform</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1705350600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 15, 2024
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1769274000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 24, 2026
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/ByteWelder">ByteWelder</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1738 words"
>
  <em>9 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  

  <div class="content">
    <p>I got inspired by Flipper Zero and started developing an application platform for ESP32 touchscreen devices.</p>

<!--more-->

<h1 id="prologue">Prologue</h1>

<p>Some time in mid-December, I was wondering if I should buy a <a href="https://flipperzero.one/">Flipper Zero</a> device.
The official website describes it as follows:</p>

<blockquote>
  <p>Flipper Zero is a portable multi-tool for pentesters and geeks in a toy-like body. It loves hacking digital stuff,
such as radio protocols, access control systems, hardware, and more. It’s fully open-source and customizable,
so you can extend it in whatever way you like.</p>
</blockquote>

<p><a href="/assets/images/posts/tactility/flipperzero.png" class="popup img-link shimmer"><img src="/assets/images/posts/tactility/flipperzero.png" alt="Flipper Zero device" class="center" loading="lazy"></a></p>
<center><small>(image by <a href="https://flipperzero.one/">Flipper Zero</a>)</small></center>

<p>I’ll refer to F0 instead of Flipper Zero in the text below.</p>

<p>F0 allows you to play around with technologies such as BlueTooth, USB, infrared, NFC and much more.
It offers a neat software development platform so you can easily output graphics and communicate with peripherals.
It also has a cute dolphin pet that levels up as you explore.
Its software is very interesting and I found myself wondering whether I could port
the code to another microcontroller (MCU).</p>

<p><a href="https://www.espressif.com">ESP32</a> has been my favourite MCU for the past few years.
Most variants of the hardware come with a multi-core 240 MHz CPU, WiFi, bluetooth, 520kB of RAM (expandable to 8MB),
several megabytes of storage and a bunch of wired connectivity options.
It’s roughly the size of a postage stamp (18 x 25.5 x 3.1 mm) and it costs about 2 EUR before adding a USB port and a battery to it.
For those who are interested: Flipper uses an STM32WB55 MCU.</p>

<p><a href="/assets/images/posts/tactility/esp32.jpg" class="popup img-link shimmer"><img src="/assets/images/posts/tactility/esp32.jpg" alt="ESP32 front and back" class="center" loading="lazy"></a></p>
<center><small>(image by <a href="https://www.espressif.com">Espressif.com</a>)</small></center>

<p>My porting efforts didn’t start out smoothly, but one thing led to another and 3 completely separate iterations later,
I’ve got something that looks usable. The result is an application platform called <a href="https://github.com/TactilityProject/Tactility">Tactility</a>.</p>

<p>Originally, I intended to port the F0 project partially to ESP32 with as little deviation from the original as possible. 
I first started with copying a ton of code and removing the bits that weren’t needed (yet) or that were blatantly incompatible.
This was not a successful approach: once everything compiled, it was too hard to debug memory corruption issues.</p>

<p>In a second attempt to make a Flipper-like platform, I tried to make everything from scratch.
It didn’t take long for me to realise that it was <em>way</em> too much work and I found myself copying in more and more bits
from the Flipper project.</p>

<p>In my third and final attempt, I did something in-between: I started building up the platform
with mostly existing F0 code. The main difference was that I was importing smaller bits and verifying them
before moving on to the next feature. I also wasn’t afraid to implement certain things radically different
if it was beneficial to the project. This worked better and I soon had a functional prototype.
It featured an application launcher and the ability to start and quit applications:</p>

<p><a href="/assets/images/posts/tactility/early-prototype.jpg" class="popup img-link shimmer"><img src="/assets/images/posts/tactility/early-prototype.jpg" alt="two devices running the software prototype for Tactility" class="center" loading="lazy"></a></p>

<h1 id="making-the-app-makes-the-platform">Making the app makes the platform</h1>

<p>Let’s dive into the software development journey…</p>

<p>It didn’t take long to build a few simple apps like “Hello world” and one that showed memory information.
I also had a ‘desktop’ app at this point, but this wasn’t very challenging as it just lists the installed applications and launches them
when you click on them.</p>

<p>When I set out to make a Wi-Fi service and related app, I didn’t know just how much it would change the entire platform!
A good Wi-Fi app does a lot more things than you’d expect. Not only is it multi-threaded, you also need to store settings.
And then there’s the increased complexity in UI and user experience.</p>

<p>As I was making this feature, it resulted in a complete change of the platform.
I started with a simple screen to toggle Wi-Fi on/off. So far so good. Then I needed an additional screen so the user can
enter credentials to connect to a network. This almost doubled the amount of code and suddenly the app had to
manage “which screen should I show - and when?”.</p>

<p>I decided to split the Wi-Fi app into two separate apps: one for the Wi-Fi overview and one for connecting to a new network.
To implement this, I now had to support:</p>
<ul>
  <li>Launching an app from another app, and being able to return to the original one.</li>
  <li>Launching an app with parameters, because I wanted to have the SSID field pre-filled when you pressed on it in the Wi-Fi overview.</li>
  <li>Storing the Wi-Fi credentials.</li>
  <li>… securely, so I had to implement encryption/decryption …</li>
  <li>… and I had to find a way to store the decryption keys in a safe (enough) manner.</li>
</ul>

<p><a href="/assets/images/posts/tactility/wifi-app.jpg" class="popup img-link shimmer"><img src="/assets/images/posts/tactility/wifi-app.jpg" alt="3 panels of the same device showing the Wi-Fi app connecting to an access point" class="center" loading="lazy"></a></p>

<h1 id="whats-in-an-app">What’s in an app?</h1>

<p>Similar to <a href="https://developer.android.com/guide/topics/manifest/manifest-intro">Android</a>
and <a href="https://github.com/search?q=repo%3Aflipperdevices%2Fflipperzero-firmware%20application.fam&amp;type=code">Flipper Zero</a>,
I created a ledger that defines a user app. It looks like this:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">static</span> <span class="kt">void</span> <span class="nf">app_show</span><span class="p">(</span><span class="n">App</span> <span class="n">app</span><span class="p">,</span> <span class="n">lv_obj_t</span><span class="o">*</span> <span class="n">parent</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">lv_obj_t</span><span class="o">*</span> <span class="n">label</span> <span class="o">=</span> <span class="n">lv_label_create</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
    <span class="n">lv_label_set_text</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="s">"Hello, world!"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">const</span> <span class="n">AppManifest</span> <span class="n">hello_world_app</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="s">"helloworld"</span><span class="p">,</span>
    <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"Hello World"</span><span class="p">,</span>
    <span class="p">.</span><span class="n">icon</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
    <span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">AppTypeUser</span><span class="p">,</span>
    <span class="p">.</span><span class="n">on_start</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
    <span class="p">.</span><span class="n">on_stop</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span>
    <span class="p">.</span><span class="n">on_show</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">app_show</span><span class="p">,</span>
    <span class="p">.</span><span class="n">on_hide</span> <span class="o">=</span> <span class="nb">NULL</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This is a functional app. It shows the text label on the screen and nothing more.
It almost looks like object-oriented programming. In fact, I might create a C++ wrapper in the future.</p>

<p>Background services work in a similar manner.
The main difference is that they don’t define <code class="language-plaintext highlighter-rouge">on_show</code>, <code class="language-plaintext highlighter-rouge">on_hide</code>, an <code class="language-plaintext highlighter-rouge">icon</code> or a human-readable <code class="language-plaintext highlighter-rouge">name</code>.</p>

<h1 id="app-lifecycle">App lifecycle</h1>

<p>When you have apps starting other apps, you can consider it as a stack, which you aproach as LIFO or “Last In, First Out”:
The last app that is put on the stack is the one that is shown to the user. It is also the first one to be closed before 
you can get back to the app that was launched before it.</p>

<p>Starting an app and closing goes like this:</p>

<ol>
  <li>Create the app (allocate data)</li>
  <li>Create the views (UI) for the app and show them</li>
  <li>Hide the app and destroy the views</li>
  <li>Destroy the app (free up data)</li>
</ol>

<p>When app A starts app B, then the views of app A would be destroyed as the app is hidden, but app A itself would not be destroyed.
When app B is closed and destroyed, the views of app A would be re-created and shown again.</p>

<p>Once I was able to launch apps onto a stack, I wanted to be able to launch them with certain parameters.
Flipper Zero originally just passed a string, but I wasn’t a fan of that: command line arguments are terrible to process.
Instead, I opted to use “bundles” <a href="https://developer.android.com/reference/android/os/Bundle">like on Android</a>.
A bundle is a sort of flexible dictionary that maps strings onto a specific set of types.
It’s a simplified in-memory database (key-value store) with a flexible type system, while still using explicit typing.</p>

<p>This is how bundles work on Tactility:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="c1">// Make a bundle and store some data in it</span>
<span class="n">Bundle</span> <span class="n">bundle</span> <span class="o">=</span> <span class="n">tt_bundle_alloc</span><span class="p">();</span>
<span class="n">tt_bundle_put_bool</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="s">"is_enabled"</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="n">tt_bundle_put_int</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="s">"count"</span><span class="p">,</span> <span class="mi">42</span><span class="p">);</span>
<span class="n">tt_bundle_put_string</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="s">"label"</span><span class="p">,</span> <span class="s">"Hello, world!"</span><span class="p">);</span>

<span class="c1">// Check if the key and value exist...</span>
<span class="kt">int</span> <span class="n">value</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">tt_bundle_opt_bool</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="s">"some_key"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// This one crashes if the key doesn't exist:</span>
<span class="n">bool</span> <span class="n">is_enabled</span> <span class="o">=</span> <span class="n">tt_bundle_get_bool</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="s">"is_enabled"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<h1 id="security-and-risk">Security and risk</h1>

<p>Typing the Wi-Fi password on a touchscreen was becoming tedious. It was happening after every reboot.
That’s why I needed to store the Wi-Fi credentials on the device.
Once encrypting and decrypting was working, I still wasn’t done.
The problem with encryption is that you need to store the secret that decodes the encrypted data.
You can ask the user every time for a password to decrypt, but then you’ve got yourself the same problem
as when entering the Wi-Fi password manually: that’s tedious!</p>

<p>The most simple way to approach this, is to create a reasonably safe random set of numbers as the key,
and store that key somewhere safe.
This approach is not safe if an attacker has physical access to your device: they can connect via USB
and fetch all the data from the flash memory (all the partitions on disk). This holds the encryption key
and the encrypted data.</p>

<p>This was pretty bad, but the solution was fairly obvious: enable boot protection and flash encryption.
The problem with these features is that they are not easy to set up. Most hobby developers won’t bother.
So, instead, I opted to show a warning when a credential is stored on an unprotected ESP32.</p>

<p>It didn’t sit right with me. I knew most hobby devs won’t bother with setting up these security features.
I knew there wasn’t much I could do to make it safe, but I found a way to make it better:
If I can use some kind of secret information that isn’t readable from flash, but also isn’t easily
available via the USB interface, perhaps I can mix this into the cryptographic key?</p>

<p>That’s where the <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/efuse.html">eFuses</a> come in:
An eFuse is a programmatic fuse. You can blow the fuse once with software, and that’s it. Each fuse can be seen as a single bit of data,
so if you have enough fuses, you can create a storage mechanism.</p>

<p>The ESP32’s eFuses already offer 6-8 bytes of random data. There is more data space, but it’s all set to 0 by default.
With the hardware identifier, I could now create the private key as follows:</p>
<ol>
  <li>Make a buffer with 32 bytes and fill it with random data (in a safe manner with a seed).</li>
  <li>Make another 32 byte buffer and fill it with the repeating hardware identifier.</li>
  <li>Perform a binary XOR operation to combine both buffers.</li>
</ol>

<p>An attack wouldn’t be as simple as just copying the data over USB. An attacker that wants to remain unseen would have to:</p>
<ol>
  <li>Copy all the flash data (complete backup)</li>
  <li>Upload a malicious app to fetch the eFuse data</li>
  <li>Re-flash the original data</li>
</ol>

<p>It’s not <em>a lot</em> more secure this way, but it sure takes a whole lot more effort.
I’ll still keep showing warnings when secure boot and flash encryption aren’t enabled though.</p>

<h1 id="whats-next">What’s next?</h1>

<p>I’m still working on UI/UX improvements for the Wi-Fi app.
The connection dialog doesn’t have a “busy” animation as it connects.
At a later stage, I also want to have Wi-Fi auto-reconnect and have the option to have Wi-Fi enabled (and connecting) on boot.</p>

<p>Right now, I’m looking at writing some tests…</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/posts/">posts</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/tactility/"
            class="post-tag no-text-decoration"
          >tactility</a>
        
          <a
            href="/tags/software/"
            class="post-tag no-text-decoration"
          >software</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=The%20making%20of%20a%20platform%20-%20ByteWelder&url=%2Fposts%2F2024%2F01%2F15%2Fthe-making-of-a-platform.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=The%20making%20of%20a%20platform%20-%20ByteWelder&u=%2Fposts%2F2024%2F01%2F15%2Fthe-making-of-a-platform.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2F2024%2F01%2F15%2Fthe-making-of-a-platform.html&text=The%20making%20of%20a%20platform%20-%20ByteWelder" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2024/01/15/the-making-of-a-platform.html">The making of a platform</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2025/01/06/tactility-one-year-later.html">Tactility...One Year Later</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2026/01/08/tactility-second-year.html">Tactility's second year</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2017/05/08/borrowing-from-kotlin.html">Borrowing from Kotlin</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2017/05/13/testing-multithreaded-code.html">Testing multithreaded code</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/software/">software</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hardware/">hardware</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tactility/">tactility</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a>
      
    </div>
  </section>


            </div>

            
              
              







            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/2026/01/08/tactility-second-year.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1767906000"
  data-df="ll"
  
>
  Jan  8, 2026
</time>

              <h4 class="pt-0 my-2">Tactility's second year</h4>
              <div class="text-muted">
                <p>The Tactility community and I have been working on many aspects over the past year: devices, apps, quality-of-life features for developers, and much more. Let’s take a close look.    How it started...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/2025/01/06/tactility-one-year-later.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1736190900"
  data-df="ll"
  
>
  Jan  6, 2025
</time>

              <h4 class="pt-0 my-2">Tactility...One Year Later</h4>
              <div class="text-muted">
                <p>Not a lot of my projects survive this long, so let’s take a look what made this one special.    How it started  It all started in December 2023, when I was considering to buy a Flipper Zero device....</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/2020/10/07/thoughts-on-multiplayer-networking.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1602104400"
  data-df="ll"
  
>
  Oct  7, 2020
</time>

              <h4 class="pt-0 my-2">Thoughts on multiplayer networking</h4>
              <div class="text-muted">
                <p>The topic of gaming and networking was brought up on the KorGE Discord server. This made me think about the various forms of networking stacks that I’ve encountered in the past years, and some of t...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/2023/05/20/building-a-handheld-pc.html"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Building a handheld PC</p>
    </a>
  

  
    <a
      href="/posts/2025/01/06/tactility-one-year-later.html"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Tactility...One Year Later</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2026</time>

    
      <a href="https://github.com/ByteWelder">ByteWelder</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.4.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/software/">software</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hardware/">hardware</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tactility/">tactility</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

